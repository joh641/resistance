manual game start and game end

steps
1) hit site
2) signIn
    if cookie, set player number to
    else, prompt for name, push PlayerSignIn event
3) all players will have a game state representation generated by snapshots
    {
      players [ { name, number } ],
      gameVersion,
      currentLeader,
      currentMission,
      failedVotes,
      previousResults,
      role
    }
4) once players all signed in, one player will run the game controller / game start
    game controller state
        leaderPosition
        roles
        schema
        failedVotes
        mission
            votes
            mission cards
        pastMissionResults

        run assignRoles, shuffle and assign images as well
    push SetRole events for each player { player, role, img }
    push SpiesReveal

        set initial leader or run move leader token
    push LeaderChange event { leaderPosition }

    push BuildTeam event { mission, numPlayers }
    listen for TeamChosen event { team }
    push TeamVote event
    listen for Vote events { vote }
        store results in this.votingResults / mission / round object
        calculate results once numPlayers vote events received
    push VotingResults event { result, votes: [ { player, vote } ] }
        if vote fails, bump failedVotes, check if game is over, if not go back to push LeaderChange step
        if game over, push GameOver event { result, roles: [ { player, role } ] }
        if vote passes, reset failedVotes
    push ConductMission event { team: [ player ] }
    listen for MissionCardChosen events { missionCard }
        store results in this.missionResults / mission / round object
        shuffle
        calculate results once mission numPlayers events received
        store results
    push MissionResults event { result, missionCards }
        if any side is at 3 wins, push GameOver event { winner, roles: [ { player, role } ] }
        else, go back to push LeaderChange event step

    game end
        reset state
        push GameClear event
        clear out firebase onGameClear
5) all clients are responsible for
    listen for SetRole event
        if player === currentPlayer, set role
        update player loyalty card to role
    listen for SpiesReveal event
        display something, then remove after a while

    listen for LeaderChange event
        move leader token
        store leaderPosition
        highlight current mission
    listen for BuildTeam event
        if leader === currentPlayer,
            allow selection of leaders (clicking of images, submit button)
            push TeamChosen event
    listen for TeamChosen event
        highlight team
    listen for TeamVote event
        display vote tokens, allow selection by clicking, submit button
        push Vote event
    listen for VotingResults event
        display each person's votes, hide after a while?
    listen for ConductMission event
        if player on mission,
            display mission cards, allow selection by clicking, submit button
            push MissionCardChosen event
    listen for MissionResults event
        display mission cards face up
        display resistance/spy win + token
        unhighlight team after a while

    always listen for gameover / gameclear
        on gameover, display roles
        on gameclear, reset state and ui

storage of votes / previous teams?
todo: steps for if a master fails, page refresh
get latest event timestamp, ignore prompt events less than?
or set push capability off until all messages loaded

future: shared stream for some events, but clients also have a separate stream between them and master
gameroom stream
user online status stream
game state instead of playing back events

UI
game lobby, watch games, chatroom/voice
picking leader in chat lobby, starting user?, next starting leader?
hi -> chat lobby -> game
chat lobby, see all users, able to select, once min number of players selected, start game is enabled

user avatars
v1 => choose from x avatars
v1 => where to put avatars? avatar circle with cards above / facing toward table

roles
v1 => cards fade in left of you clockwise
v1 => once it reaches you cycle, click and cycle through images
v1 => or flip over and show your role
v2 => deal out cards animation

can click to flip role between hidden and not hidden
leader token already there

call to action for selecting team, all other stuff surrounding blurs
google initials circle
select your team text above game board
below, team: and appropriate number of circles based on round
circles have pluses, click plus, everything except avatars blurs
hover on person, giant x
or x circle on top right of avatar
gun token near team members

vote, vote tokens appear near avatar area
section slides out from mission board, yes or no tokens, confirm, slides back
vote tokens come out from avatar circles
v2 => votes collect in front of you
strip appears on gameboard, gray out above and below, vote results, disappears
vote tokens disappear
vote circle filled in if mission failed, cleared if passed

mission cards fade in next to people in team
slide down mission success or fail if user in team
all cards slide into middle
flip over
strip display results
mission cards disappear
round circle filled in with winner

change leader announcement after failed vote or mission result
leader token fades, fades in to next leader

gameover
make role cards bigger, avatar goes to some corner
flip over role cards
you win or you lose message
fade out for play again or exit

http://games.asobrain.com/
https://www.youtube.com/watch?v=6AMOVtxwtHA
http://www.theresistanceonline.com/
https://github.com/cashto/resistance

// READ
// their role
// names of other players
// mission track
  // mission number
  // number of players per mission
  // pass/fail status
  // fails required if > 1
// vote track
// number of players, number of spies
// mission leader
// mission candidates
// mission votes
// mission pass/fails

// WRITE
// mission candidates if leader
// mission votes
// mission pass/fail if in mission

<!DOCTYPE html>
<html>
<head>
  <title>The Resistance</title>
  <link rel="stylesheet" type="text/css" href="/assets/resistance.css">
  <script src="https://cdn.firebase.com/js/client/2.2.1/firebase.js"></script>
</head>
<body>
  <script src="/assets/resistance.js"></script>
  <div class="screen">
    <div class="game">
      <div class="player player--1">
        <div class="player__icon"></div>
        <div class="player__role player__role--face-down"></div>
        <div class="player__leader-token player__leader-token--hidden"></div>
        <div class="player__vote player__vote--accept player__vote--face-down"></div>
        <div class="player__vote player__vote--reject player__vote--face-down"></div>
        <div class="player__mission-card player__mission-card--hidden"></div>
        <div class="player__mission-card player__mission-card--hidden"></div>
      </div>
      <div class="player player--2">
        <div class="player__icon"></div>
        <div class="player__role player__role--face-down"></div>
        <div class="player__leader-token player__leader-token--hidden"></div>
        <div class="player__vote player__vote--accept player__vote--face-down"></div>
        <div class="player__vote player__vote--reject player__vote--face-down"></div>
        <div class="player__mission-card player__mission-card--hidden"></div>
        <div class="player__mission-card player__mission-card--hidden"></div>
      </div>
      <div class="player player--3">
        <div class="player__icon"></div>
        <div class="player__role player__role--face-down"></div>
        <div class="player__leader-token player__leader-token--hidden"></div>
        <div class="player__vote player__vote--accept player__vote--face-down"></div>
        <div class="player__vote player__vote--reject player__vote--face-down"></div>
        <div class="player__mission-card player__mission-card--hidden"></div>
        <div class="player__mission-card player__mission-card--hidden"></div>
      </div>
      <div class="player player--4">
        <div class="player__icon"></div>
        <div class="player__role player__role--face-down"></div>
        <div class="player__leader-token player__leader-token--hidden"></div>
        <div class="player__vote player__vote--accept player__vote--face-down"></div>
        <div class="player__vote player__vote--reject player__vote--face-down"></div>
        <div class="player__mission-card player__mission-card--hidden"></div>
        <div class="player__mission-card player__mission-card--hidden"></div>
      </div>
      <div class="player player--5">
        <div class="player__icon"></div>
        <div class="player__role player__role--face-down"></div>
        <div class="player__leader-token player__leader-token--hidden"></div>
        <div class="player__vote player__vote--accept player__vote--face-down"></div>
        <div class="player__vote player__vote--reject player__vote--face-down"></div>
        <div class="player__mission-card player__mission-card--hidden"></div>
        <div class="player__mission-card player__mission-card--hidden"></div>
      </div>
      <div class="player player--current">
        <div class="player__icon"></div>
        <div class="player__role player__role--spy"></div>
        <div class="player__leader-token"></div>
        <div class="player__vote player__vote--accept player__vote--face-down"></div>
        <div class="player__vote player__vote--reject player__vote--face-down"></div>
        <div class="player__mission-card player__mission-card--hidden"></div>
        <div class="player__mission-card player__mission-card--hidden"></div>
      </div>
      <div class="game__area">
        <div class="game__table">
          <div class="game__table__top">
            <div class="game__table__top__display"></div>
          </div>
          <div class="game__table__middle">
            <div class="game__table__middle__strip"></div>
            <div class="game__board">
              <div class="game__board__panel"></div>
              <div class="game__board__results"</div>
            </div>
          </div>
          <div class="game__table__bottom">
            <div class="game__table__bottom__results"></div>
          </div>
        </div>
        <div class="game__table__decision-panel">
          <div class="vote-tokens">
            <div class="vote-token vote-token--accept"></div>
            <div class="vote-token vote-token--reject"></div>
          </div>
          <div class="mission-cards">
            <div class="mission-card mission-card--success"></div>
            <div class="mission-card mission-card--fail"></div>
          </div>
          <button class="submit" disabled="true">Submit</button>
        </div>
      </div>
    </div>
    <div class="chat-panel"></div>
  </div>
</body>
</html>

.screen {

}

.player {
  &__icon {

  }

  &__role {
    &--face-down {

    }

    &--resistance {

    }

    &--spy {

    }
  }

  &__leader-token {
    &--hidden {

    }
  }

  &__vote {
    &--face-down {

    }

    &--accept {

    }

    &--reject {

    }
  }

  &__mission-card {
    &--hidden {

    }
  }
}

.game {
  &__area {

  }

  &__board {
    &__panel {

    }

    &__results {

    }
  }

  &__table {
    &__top {
      &__display {

      }
    }

    &__middle {
      &__strip {

      }
    }

    &__bottom {
      &__results {

      }
    }

    &__decision-panel {
      &--open {

      }

      &--vote {
        .vote-tokens {

        }
      }

      .vote-tokens {
        .vote-token {
          &--accept {

          }

          &--reject {

          }

          &--selected {

          }
        }
      }

      &--mission {
        .mission-cards {

        }
      }

      .mission-cards {
        .mission-card {
          &--success {

          }

          &--fail {

          }

          &--selected {

          }
        }
      }

      .submit {

      }
    }
  }
}

.chat-panel {

}
